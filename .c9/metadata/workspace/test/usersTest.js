{"changed":true,"filter":false,"title":"usersTest.js","tooltip":"/test/usersTest.js","value":"var should = require('should'); \nvar assert = require('assert');\nvar request = require('supertest');  \nvar mongoose = require('mongoose');\nvar winston = require('winston');\n\ndescribe('Users', function() {\n  var url = 'https://fypserver-jamesgallagher.c9.io';\n \n  before(function(done) {\n    // In our tests we use the test db\n    mongoose.connect('mongodb://james:password1@ds031741.mongolab.com:31741/testfyp');\n    done();\n  });\n\n  //Tesing the registraion of a user with an existing parameter\n  describe('Test ID Users1: Registering an existing user', function() {\n    it('should return error trying to save duplicate username', function(done) {\n\n    request(url)\n\t.post('/api/users')\n\t.send({name: 'james',\n        pass: 'james',\n        email:'test@test'})\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n  \n  //Tesing the registraion of a user with a missing paramerter\n  describe('Test ID Users2: Registering a new user missing a required parameter', function() {\n    it('should return a error!', function(done) {\n    request(url)\n\t.post('/api/users')\n\t.send({\n        pass: 'test',\n        email:'test@test'\n      })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n  \n  \n//Tesing the registraion of a user with a well formed request\n describe('Test ID Users3: Registering a new user', function() {\n    it('should return a success!', function(done) {\n\n    request(url)\n\t.post('/api/users')\n\t.send({\n        name: 'NewUser10',\n        pass: 'test',\n        email:'test10@test'\n      })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(200);\n            done();\n        });\n    });\n  });\n\n \n //Tesing the registraion of a user with a well formed request\n describe('Test ID Users4: Attempting to log in with a wrong user name', function() {\n    it('should return an error!', function(done) {\n\n    request(url)\n\t.post('/api/auth')\n\t.send({\n        user_id: 'madeup',\n        pass: 'james',\n       \n      })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n\n  //Tesing the registraion of a user with a well formed request\n describe('Test ID Users5: Attempting to log in with a wrong password', function() {\n    it('should return an error!', function(done) {\n\n    request(url)\n\t.post('/api/auth')\n\t.send({\n        user_id: 'james',\n        pass: 'wrongpass',\n       \n      })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n\n   //Tesing the registraion of a user with a well formed request\n describe('Attempting to log in with correct credentials', function() {\n    it('should return an success!', function(done) {\n\n    request(url)\n\t.post('/api/auth')\n\t.send({\n        user_id: 'james',\n        pass: 'james',\n       \n      })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(200);\n            done();\n        });\n    });\n  });\n    describe('Test ID Req1: Sending a request with no message', function() {\n    it('should return error.', function(done) {\n    request(url)\n\t.post('/api/requests')\n\t.send({\n   userid:\"54e7f32ff86afc444700000c\",\n   state:1,\n   time: new Date(),\n   lat:'-2',\n   long:'52',\n   ttl :100\n  })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n  \ndescribe('Test ID Req2: Sending a request with no latitude', function() {\n    it('should return error.', function(done) {\n    request(url)\n\t.post('/api/requests')\n\t.send({\n   userid:\"54e7f32ff86afc444700000c\",\n   state:1,\n   time: new Date(),\n   \n   long:'52',\n    message:'test',\n\n   ttl :100\n  })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n  \n  describe('Test ID Req3: Sending a request with no longitude', function() {\n    it('should return error.', function(done) {\n    request(url)\n\t.post('/api/requests')\n\t.send({\n   userid:\"54e7f32ff86afc444700000c\",\n   state:1,\n   time: new Date(),\n   \n   lat:'-2',\n    message:'test',\n\n   ttl :100\n  })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n  \n    describe('Test ID Req4: Sending a request with no user id', function() {\n    it('should return error.', function(done) {\n    request(url)\n\t.post('/api/requests')\n\t.send({\n     state:1,\n    time: new Date(),\n    long:'52',\n   lat:'-2',\n    message:'test',\n\n   ttl :100\n  })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n  \n  \n        describe('Test ID Req5: Sending a request with incorrect user id', function() {\n    it('should return error.', function(done) {\n    request(url)\n\t.post('/api/requests')\n\t.send({\n      userid:\"This is nonsense\",\n\n     state:1,\n    time: new Date(),\n    long:'52',\n   lat:'-2',\n    message:'test',\n\n   ttl :100\n  })\n    // end handles the response\n\t.end(function(err, res) {\n          if (err) {\n            throw err;\n          }\n            res.status.should.be.equal(400);\n            done();\n        });\n    });\n  });\n });","undoManager":{"mark":98,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":125,"column":27},"end":{"row":125,"column":28},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":125,"column":28},"end":{"row":125,"column":29},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":125,"column":29},"end":{"row":125,"column":30},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":125,"column":30},"end":{"row":125,"column":31},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":125,"column":31},"end":{"row":125,"column":32},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":100,"column":0},"end":{"row":100,"column":4},"action":"remove","lines":[" });"]}]}],[{"group":"doc","deltas":[{"start":{"row":122,"column":0},"end":{"row":122,"column":4},"action":"remove","lines":[" });"]}]}],[{"group":"doc","deltas":[{"start":{"row":144,"column":0},"end":{"row":144,"column":4},"action":"remove","lines":[" });"]}]}],[{"group":"doc","deltas":[{"start":{"row":77,"column":0},"end":{"row":77,"column":4},"action":"remove","lines":[" });"]}]}],[{"group":"doc","deltas":[{"start":{"row":144,"column":0},"end":{"row":144,"column":4},"action":"insert","lines":[" });"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"remove","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":8},"end":{"row":106,"column":9},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":9},"end":{"row":106,"column":10},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":10},"end":{"row":106,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":128,"column":8},"end":{"row":128,"column":9},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":128,"column":9},"end":{"row":128,"column":10},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":128,"column":10},"end":{"row":128,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":8},"end":{"row":84,"column":9},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":9},"end":{"row":84,"column":10},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":10},"end":{"row":84,"column":11},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":19},"end":{"row":41,"column":20},"action":"remove","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":19},"end":{"row":41,"column":20},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":42,"column":24},"end":{"row":42,"column":25},"action":"remove","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":42,"column":24},"end":{"row":42,"column":25},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":42,"column":24},"end":{"row":42,"column":25},"action":"remove","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":41,"column":19},"end":{"row":41,"column":20},"action":"remove","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["4"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"remove","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"insert","lines":["4"]}]}],[{"group":"doc","deltas":[{"start":{"row":128,"column":8},"end":{"row":128,"column":9},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":106,"column":8},"end":{"row":106,"column":9},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":8},"end":{"row":84,"column":9},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["4"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["5"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"remove","lines":["4"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"insert","lines":["5"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"remove","lines":["5"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"insert","lines":["6"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["5"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["6"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["6"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["7"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"remove","lines":["6"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"insert","lines":["9"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["7"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["9"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":10},"end":{"row":6,"column":17},"action":"remove","lines":["Routing"]},{"start":{"row":6,"column":10},"end":{"row":6,"column":11},"action":"insert","lines":["U"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":11},"end":{"row":6,"column":12},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":12},"end":{"row":6,"column":13},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":13},"end":{"row":6,"column":14},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":13},"end":{"row":6,"column":14},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":12},"end":{"row":6,"column":13},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":12},"end":{"row":6,"column":13},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":13},"end":{"row":6,"column":14},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":14},"end":{"row":6,"column":15},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":12},"end":{"row":16,"column":13},"action":"insert","lines":["U"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":13},"end":{"row":16,"column":14},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":14},"end":{"row":16,"column":15},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":15},"end":{"row":16,"column":16},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":16},"end":{"row":16,"column":17},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":17},"end":{"row":16,"column":18},"action":"insert","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":18},"end":{"row":16,"column":19},"action":"insert","lines":[":"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":19},"end":{"row":16,"column":20},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":12},"end":{"row":16,"column":13},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":13},"end":{"row":16,"column":14},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":14},"end":{"row":16,"column":15},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":15},"end":{"row":16,"column":16},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":16},"end":{"row":16,"column":17},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":17},"end":{"row":16,"column":18},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":18},"end":{"row":16,"column":19},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":19},"end":{"row":16,"column":20},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":12},"end":{"row":36,"column":27},"action":"insert","lines":["Test ID Users1:"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":27},"end":{"row":36,"column":28},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":25},"end":{"row":36,"column":26},"action":"remove","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":25},"end":{"row":36,"column":26},"action":"insert","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":11},"end":{"row":57,"column":26},"action":"insert","lines":["Test ID Users1:"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":26},"end":{"row":57,"column":27},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":24},"end":{"row":57,"column":25},"action":"remove","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":57,"column":24},"end":{"row":57,"column":25},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":11},"end":{"row":80,"column":26},"action":"insert","lines":["Test ID Users1:"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":26},"end":{"row":80,"column":27},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":24},"end":{"row":80,"column":25},"action":"remove","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":24},"end":{"row":80,"column":25},"action":"insert","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":24},"end":{"row":80,"column":25},"action":"remove","lines":["3"]}]}],[{"group":"doc","deltas":[{"start":{"row":80,"column":24},"end":{"row":80,"column":25},"action":"insert","lines":["4"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":11},"end":{"row":102,"column":26},"action":"insert","lines":["Test ID Users1:"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":26},"end":{"row":102,"column":27},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":24},"end":{"row":102,"column":25},"action":"remove","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":24},"end":{"row":102,"column":25},"action":"insert","lines":["5"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"remove","lines":["9"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":23},"end":{"row":63,"column":24},"action":"insert","lines":["0"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"remove","lines":["9"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":19},"end":{"row":65,"column":20},"action":"insert","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":20},"end":{"row":65,"column":21},"action":"insert","lines":["0"]}]}],[{"group":"doc","deltas":[{"start":{"row":143,"column":5},"end":{"row":144,"column":0},"action":"insert","lines":["",""]},{"start":{"row":144,"column":0},"end":{"row":144,"column":2},"action":"insert","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":144,"column":2},"end":{"row":266,"column":5},"action":"insert","lines":["  describe('Test ID Req1: Sending a request with no message', function() {","    it('should return error.', function(done) {","    request(url)","\t.post('/api/requests')","\t.send({","   userid:\"54e7f32ff86afc444700000c\",","   state:1,","   time: new Date(),","   lat:'-2',","   long:'52',","   ttl :100","  })","    // end handles the response","\t.end(function(err, res) {","          if (err) {","            throw err;","          }","            res.status.should.be.equal(400);","            done();","        });","    });","  });","  ","describe('Test ID Req2: Sending a request with no latitude', function() {","    it('should return error.', function(done) {","    request(url)","\t.post('/api/requests')","\t.send({","   userid:\"54e7f32ff86afc444700000c\",","   state:1,","   time: new Date(),","   ","   long:'52',","    message:'test',","","   ttl :100","  })","    // end handles the response","\t.end(function(err, res) {","          if (err) {","            throw err;","          }","            res.status.should.be.equal(400);","            done();","        });","    });","  });","  ","  describe('Test ID Req3: Sending a request with no longitude', function() {","    it('should return error.', function(done) {","    request(url)","\t.post('/api/requests')","\t.send({","   userid:\"54e7f32ff86afc444700000c\",","   state:1,","   time: new Date(),","   ","   lat:'-2',","    message:'test',","","   ttl :100","  })","    // end handles the response","\t.end(function(err, res) {","          if (err) {","            throw err;","          }","            res.status.should.be.equal(400);","            done();","        });","    });","  });","  ","    describe('Test ID Req4: Sending a request with no user id', function() {","    it('should return error.', function(done) {","    request(url)","\t.post('/api/requests')","\t.send({","     state:1,","    time: new Date(),","    long:'52',","   lat:'-2',","    message:'test',","","   ttl :100","  })","    // end handles the response","\t.end(function(err, res) {","          if (err) {","            throw err;","          }","            res.status.should.be.equal(400);","            done();","        });","    });","  });","  ","  ","        describe('Test ID Req5: Sending a request with incorrect user id', function() {","    it('should return error.', function(done) {","    request(url)","\t.post('/api/requests')","\t.send({","      userid:\"This is nonsense\",","","     state:1,","    time: new Date(),","    long:'52',","   lat:'-2',","    message:'test',","","   ttl :100","  })","    // end handles the response","\t.end(function(err, res) {","          if (err) {","            throw err;","          }","            res.status.should.be.equal(400);","            done();","        });","    });","  });"]}]}]]},"ace":{"folds":[],"scrolltop":3481,"scrollleft":0,"selection":{"start":{"row":266,"column":5},"end":{"row":266,"column":5},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":231,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1425611622762}